<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0057)http://www.devx.com/opensource/Article/20247/1954?pf=true -->
<!-- <widgetwrapper> --><HTML><HEAD><TITLE>Create Python Executables Automatically</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1"><LINK 
href="Create Python Executables Automatically_files/cps.css" type=text/css 
rel=stylesheet><LINK href="Create Python Executables Automatically_files/pf.css" 
type=text/css rel=stylesheet>
<META content="" name=keywords>
<META 
content="The py2exe project gave Python authors a way to create executable files, but using it can be time-consuming; particularly when you need to create executables repeatedly. Here's how to automate the process." 
name=Description>
<META 
content="955 Python -- Products and Technologies :: Languages :: Programming Languages :: Scripting Languages :: Python" 
name=Topic>
<SCRIPT language=javascript 
src="Create Python Executables Automatically_files/globalFuncs.js"></SCRIPT>

<META content="MSHTML 6.00.2800.1400" name=GENERATOR></HEAD>
<BODY bgColor=#fafae6><!-- <widgetwrapper> -->
<SCRIPT language=javascript>
function showSupportItem(itemName)
{
	if( articleSpptItems[itemName] )
	{
		var theURL = 'http://www.devx.com/opensource/Article/20247/1763';
		theURL += '?supportItem='+articleSpptItems[itemName].number;
		popUpWindow(theURL, articleSpptItems[itemName].width, articleSpptItems[itemName].height);
	}
	else
		alert("Sorry, "+itemName+" could not be found.");
}
function SupportItem(number, width, height)
{
	this.number = number;
	this.width = width;
	this.height = height;
	return this;
}
articleSpptItems = new Object();

articleSpptItems.figure1 = new SupportItem(1,610,434);

articleSpptItems.talkback = new SupportItem(2,200,300);

articleSpptItems.listing1 = new SupportItem(3,800,600);

</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD>
      <DIV><A href="http://www.devx.com/"><IMG alt="DevX HomePage" 
      src="Create Python Executables Automatically_files/4055.gif" 
      border=0></A></DIV></TD>
    <TD>&nbsp;</TD></TR>
  <TR>
    <TD class=topPrintHeader align=left><A 
      href="http://www.devx.com/">http://www.devx.com/</A></TD>
    <TD class=topPrintHeader align=right>Printed from <A 
      href="http://www.devx.com/opensource/Article/20247">http://www.devx.com/opensource/Article/20247</A></TD></TR>
  <TR>
    <TD>&nbsp;</TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD>
      <DIV class=articleTitle>Create Python Executables Automatically</DIV>
      <DIV class=articleDek><BR>The py2exe project gave Python authors a way to 
      create executable files, but using it can be time-consuming; particularly 
      when you need to create executables repeatedly. Here's how to automate the 
      process.&nbsp;
      <DIV>
      <DIV class=articleAuthor>by Premshree Pillai </DIV></DIV></DIV></TD></TR>
  <TR>
    <TD><IMG height=24 
      src="Create Python Executables Automatically_files/3591.gif" width=23 
      align=left><!-- END DROPCAP - FIRST PARAGRAPH -->his article shows you how 
      to automate the task of creating Python executables via <SPAN 
      class=pf>py2exe</SPAN> using Python itself. I call the Python file 
      containing the code <SPAN class=pf>makeExe.py</SPAN>. This technique 
      requires only one file, <SPAN class=pf>makeExe.py</SPAN>; it creates all 
      other necessary files at run-time. First, a short review on the process of 
      creating a Python executable using <SPAN 
      class=pf>py2exe</SPAN>.<BR><BR><B>Creating a Python Executable</B><BR>The 
      following four steps describe the process required to create a Python 
      executable.<BR><BR>
      <OL>
        <LI>First create a Python script. 
        <LI>Create a setup file that includes the name of your setup and also 
        the name of the file whose executable you want to create. 
        <LI>Run your Python script from the command line, for example, <SPAN 
        class=pf>python yourFile.py py2exe</SPAN>. 
        <LI>Creating a new setup file or modifying an existing one each time you 
        need to create an executable is onerous. Wouldn't it be better to have 
        these steps integrated into one? That's exactly what the Python sample 
        code for this article, <SPAN class=pf>makeExe.py</SPAN> does. </LI></OL>
      <TABLE style="BACKGROUND: white; COLOR: red" cellPadding=3 width="60%" 
      align=center border=1>
        <TBODY>
        <TR>
          <TD>Author's Note: You can get <SPAN class=pf>py2exe</SPAN> <A 
            href="http://starship.python.net/crew/theller/py2exe/" 
            target=_blank>here</A>. You'll also find the full instructions for 
            using <SPAN class=pf>py2exe</SPAN> via that 
      link.</TD></TR></TBODY></TABLE><BR><B>How the makeExe.py File 
      Works</B><BR><A href="javascript:showSupportItem('listing1');">Listing 
      1</A> contains the full contents of the <SPAN class=pf>makeExe.py</SPAN> 
      file. When you run this file (you should run it from the Python root 
      directory), it asks the user for a file name, then creates an executable 
      for the specified file (see <A 
      href="javascript:showSupportItem('figure1');">Figure 1</A>). The short 
      code excerpts that follow explain how the code works.<BR><BR>
      <TABLE cellSpacing=0 cellPadding=5 width=425 border=0>
        <TBODY>
        <TR>
          <TD vAlign=top><A href="javascript:showSupportItem('figure1');"><IMG 
            height=266 alt="" 
            src="Create Python Executables Automatically_files/9187.jpeg" 
            width=425 border=0></A></TD>
          <TD width=12>&nbsp;</TD></TR>
        <TR>
          <TD class=smallfont><A 
            href="javascript:showSupportItem('figure1');">Figure 1</A>. A Simple 
            UI: The makeExe.py file running in a command window requests a file 
            path to the file for which the user wants to create an 
        executable.</TD></TR></TBODY></TABLE>First, the code imports the modules 
      <SPAN class=pf>sys</SPAN> and <SPAN class=pf>re</SPAN>. You need the <SPAN 
      class=pf>sys</SPAN> module to manipulate the command-line arguments, and 
      the re module to extract the filename (without the <SPAN 
      class=pf>.py</SPAN> extension) from the file path entered by the 
      user.<BR><BR><PRE><CODE>   import sys
   import re
</CODE></PRE>Next, it asks the user for the file name from which to create 
      the executable. The code accepts relative file paths as well as full file 
      names. The code also ensures that the specified file exists.<BR><BR><PRE><CODE>   def getFileName():
      global fileName
      fileName = raw_input(
         "Enter file name (rel or abs path, eg., 
         python/file.py): ")
      try:
         fp = open(fileName)
         fp.close()
      except IOError:
         print "File does not exist!"
         getFileName()
   
   getFileName()
</CODE></PRE><BR>
      <P><BR><BR></P></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD></TD></TR>
  <TR>
    <TD><B>How the MakeExe.py File Works (cont.)</B><BR>You need to extract 
      the file name (minus the extension) from the file path that the user has 
      specified. The code below assigns that file name to variable <SPAN 
      class=pf>package</SPAN>, which you need to create the setup file. For 
      example, if the specified file path is <SPAN 
      class=pf>python/somePyFile.py</SPAN>, then at the end of the code 
      fragment, <SPAN class=pf>package</SPAN> will hold the value <SPAN 
      class=pf>somePyFile</SPAN>.<BR><BR><PRE><CODE>   package = re.split(":",fileName)
   package = re.split("/",package[len(package) - 1])
   package = re.split(".py",package[len(package) - 1])
   package = package[0]
</CODE></PRE>The next task is to write a setup file containing the 
      commands required to create the executable. The code asks the user for the 
      name of the setup file. If the user simply presses the Enter key, the 
      setup file name defaults to <SPAN class=pf>setup.py</SPAN>.<BR><BR><PRE><CODE>  def getSetupName():
      global setupName
      setupName = raw_input("Enter name of setup file (or &lt;enter&gt; for default): ")
      if(setupName == ''):
         setupName = "setup.py"
      try:
         fp = open(setupName)
         fp.close()
         flag = raw_input("Setup file exists! Rewrite (0=no; else &lt;enter&gt;)? ")
         if(flag == "1"):
            getSetupName()
      except IOError:
         setupName = setupName
   getSetupName()
</CODE></PRE>The following code writes that information into the setup 
      file. If the file does not exist, the code creates it. If the file exists, 
      the code asks the user to confirm that it should overwrite the 
      file.<BR><BR><PRE><CODE>   fp = open(setupName,"w")
   temp = """from distutils.core import setup
   import py2exe
   setup(name = "%s",
      scripts = ["%s"],
      )""" % (package,fileName)
</CODE></PRE>For example, if a user enters the file path <SPAN 
      class=pf>python/fader.py, </SPAN>the variable <SPAN 
      class=pf>package</SPAN> gets set to <SPAN class=pf>fader</SPAN>, and then 
      the <SPAN class=pf>setup.py</SPAN> file will contain the following 
      text:<BR><BR><PRE><CODE>   from distutils.core import setup 
   import py2exe 
   setup(name="fader", 
        scripts=["python/fader.py"], 
   )
</CODE></PRE>Note that the above data remains in the file only during this 
      stage.<BR><BR>You could run the <SPAN class=pf>setup.py</SPAN> file 
      manually, but it's much more convenient to automate that as well. To do 
      that, you need to be able to add <SPAN class=pf>py2exe</SPAN> to the 
      command-line for the <SPAN class=pf>setup.py</SPAN> file, and then launch 
      it.<BR><BR>You can manipulate the command-line via the Python <SPAN 
      class=pf>globals()</SPAN> dictionary, which contains information about a 
      number of objects, among which is the <SPAN class=pf>sys</SPAN> object. 
      The sys object exposes the <SPAN class=pf>argv</SPAN> list, which contains 
      the list of command-line arguments. Using the <SPAN 
      class=pf>sys.argv</SPAN> list, you can manipulate (and modify) 
      command-line arguments. The following line appends <SPAN 
      class=pf>py2exe</SPAN> to the command-line arguments list; that 
      command-line argument is required to successfully create an 
      executable.<BR><BR><PRE><CODE>   sys.argv.append("py2exe")
</CODE></PRE>To create the executable, you dynamically execute the file 
      <SPAN class=pf>setup.py</SPAN> created earlier using Python's <SPAN 
      class=pf>execfile()</SPAN> method.<BR><BR><PRE><CODE>   execfile(setupName)
</CODE></PRE>The <SPAN class=pf>execfile(fileName)</SPAN> method basically 
      performs the following steps:<BR><BR><PRE><CODE>   fp = open(fileName,'r')
   exec f
   f.close()
</CODE></PRE>Calling the <SPAN class=pf>execfile()</SPAN> method is 
      equivalent to the preceding three sequential steps; in other words, 
      executing <SPAN class=pf>setup.py</SPAN> programmatically is equivalent to 
      running the file <SPAN class=pf>setup.py</SPAN> from the command-line with 
      a command-line argument of py2exe, for example:<BR><BR><PRE><CODE>   D:\python22&gt;python setup.py py2exe
</CODE></PRE>Finally, the last lines in <A 
      href="javascript:showSupportItem('listing1');">Listing 1</A> clear the 
      file <SPAN class=pf>setup.py</SPAN>. Thus, after the script executes, 
      <SPAN class=pf>setup.py</SPAN> becomes a blank file, ready for the next 
      cycle.<BR><BR>When you run <SPAN class=pf>py2exe</SPAN> it creates the 
      output executable in the <SPAN class=pf>/dist/&lt;package&gt;</SPAN> 
      directory.<BR><BR><B>Save Yourself Some Time</B><BR>Without using 
      makeExe.py, assuming you already have a setup file template ready, you 
      will first need to edit the file, add the required information, and then 
      save it. Next, you must go to the command line and then type the string to 
      create the executable. But using <SPAN class=pf>makeExe.py</SPAN>, you 
      just need to double-click on it and then enter the file path for the 
      Python file from which you want to make an executable, and it creates the 
      executable and saves it for you. Without any doubt, the latter task is 
      less far irksome and time-consuming, particularly when you need to create 
      a number of Python executables.<BR><BR><B>Future Work</B><BR>This article 
      explains the underlying technique involved in automating the creation of 
      Python executables. Enhancements in the form of a graphical user 
      interface, using Tk or wxPython, would be desirable, as would batch 
      creation of executables.<BR><BR>
      <P>
      <DIV class=""><B>Premshree Pillai</B> studies engineering in Information 
      Technology at Mumbai University, Mumbai, India. He is a programming 
      enthusiast and maintains a <A href="http://www.qiksearch.com/" 
      target=_blank>Web site</A>, where he posts his scripts. He is also a 
      freelance writer and has written for a range of popular Indian magazines. 
      </DIV><BR><BR></TD></TR></TBODY></TABLE><!-- </widgetwrapper> --><!-- <widgetwrapper> --><!-- cache: WT175_W1992v2_C20247v1  02/26/2004 03:39:27 -->
<TABLE style="PADDING-TOP: 10px" cellSpacing=0 cellPadding=0 width="100%" 
border=0>
  <TBODY>
  <TR>
    <TD class=smallFont align=middle>DevX is a division of Jupitermedia 
      Corporation <BR>© Copyright 2004 Jupitermedia Corporation. All Rights 
      Reserved. <A href="http://www.internet.com/corporate/legal.html">Legal 
      Notices</A></TD></TR></TBODY></TABLE><!-- </widgetwrapper> --><!-- </widgetwrapper> --><!-- 203.28.240.20 web3 --></BODY></HTML>
